<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>remix: Sndfile demo</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="annotated.html">Data&nbsp;Structures</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Data&nbsp;Fields</a> | <a class="qindex" href="globals.html">Globals</a></div>
<h1>Sndfile demo</h1><div class="fragment"><pre><span class="comment">/*</span>
<span class="comment"> * sndfiledemo.c</span>
<span class="comment"> *</span>
<span class="comment"> * Copyright (C) 2001 Commonwealth Scientific and Industrial Research</span>
<span class="comment"> * Organisation (CSIRO), Australia.</span>
<span class="comment"> *</span>
<span class="comment"> * Permission to use, copy, modify, distribute, and sell this software and</span>
<span class="comment"> * its documentation for any purpose is hereby granted without fee, provided</span>
<span class="comment"> * that the above copyright notice appear in all copies and that both that</span>
<span class="comment"> * copyright notice and this permission notice appear in supporting</span>
<span class="comment"> * documentation.  No representations are made about the suitability of this</span>
<span class="comment"> * software for any purpose.  It is provided "as is" without express or</span>
<span class="comment"> * implied warranty.</span>
<span class="comment"> *</span>
<span class="comment"> */</span>

<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>

<span class="preprocessor">#include &lt;<a class="code" href="remix_8h.html">remix/remix.h</a>&gt;</span>

<span class="keywordtype">int</span>
main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> ** argv)
{
  <a class="code" href="remix__types_8h.html#a33">RemixEnv</a> * env;
  <a class="code" href="remix__types_8h.html#a39">RemixDeck</a> * deck, * deck2;
  <a class="code" href="remix__types_8h.html#a40">RemixTrack</a> * track, * track2, * track3;
  <a class="code" href="remix__types_8h.html#a41">RemixLayer</a> * l1, * l2, * l3, * l4, * l5;
  <a class="code" href="remix__types_8h.html#a27">RemixBase</a> * sf1, * sf2;
  <a class="code" href="remix__types_8h.html#a46">RemixSquareTone</a> * square;
  <a class="code" href="remix__types_8h.html#a25">RemixCount</a> length;
  <a class="code" href="remix__types_8h.html#a47">RemixMonitor</a> * monitor;
  <a class="code" href="remix__types_8h.html#a42">RemixSound</a> * sm;
  <a class="code" href="remix__types_8h.html#a35">RemixEnvelope</a> * envelope;
  <a class="code" href="remix__types_8h.html#a45">RemixPlugin</a> * gain_plugin;
  <a class="code" href="remix__types_8h.html#a45">RemixPlugin</a> * sf_plugin;
  <a class="code" href="remix__types_8h.html#a27">RemixBase</a> * gain;
  CDSet * sf_parms;
  <span class="keywordtype">int</span> i;
  <span class="keywordtype">int</span> gain_key;
  <span class="keywordtype">int</span> sf_path_key;

  env = <a class="code" href="remix_8h.html#a2">remix_init</a> ();
  <a class="code" href="remix_8h.html#a9">remix_set_tempo</a> (env, 140);
  <a class="code" href="remix_8h.html#a11">remix_set_channels</a> (env, REMIX_STEREO);

<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  sf1 = remix_sndfile_new (env, <span class="stringliteral">"./1052.wav"</span>, 0);
  sf2 = remix_sndfile_new (env, <span class="stringliteral">"./909_cl.wav"</span>, 0);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  sf_plugin = <a class="code" href="remix_8h.html#a13">remix_find_plugin</a> (env, <span class="stringliteral">"builtin::sndfile_reader"</span>);
  sf_parms = cd_set_new (env);
  sf_path_key = <a class="code" href="remix_8h.html#a16">remix_get_init_parameter_key</a> (env, sf_plugin, <span class="stringliteral">"path"</span>);
  sf_parms = cd_set_insert (env, sf_parms, sf_path_key,
                            CD_STRING(<span class="stringliteral">"./1052.wav"</span>));
  <span class="keywordflow">if</span> (sf_plugin == NULL) {
    fprintf (stderr, <span class="stringliteral">"sf_plugin == NULL\n"</span>);
    exit (1);
  }
  sf1 = <a class="code" href="remix_8h.html#a14">remix_new</a> (env, sf_plugin, sf_parms);
  sf_parms = cd_set_replace (env, sf_parms, 1, CD_STRING(<span class="stringliteral">"909_cl.wav"</span>));
  sf2 = <a class="code" href="remix_8h.html#a14">remix_new</a> (env, sf_plugin, sf_parms);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  square = <a class="code" href="remix_8h.html#a38">remix_squaretone_new</a> (env, 220);
  monitor = <a class="code" href="remix_8h.html#a41">remix_monitor_new</a> (env);

<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  gain = remix_gain_new (env);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  gain_plugin = <a class="code" href="remix_8h.html#a13">remix_find_plugin</a> (env, <span class="stringliteral">"builtin::gain"</span>);
  gain = <a class="code" href="remix_8h.html#a14">remix_new</a> (env, gain_plugin, NULL);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
  envelope = <a class="code" href="remix__envelope_8h.html#a0">remix_envelope_new</a> (env, REMIX_ENVELOPE_LINEAR);
  <a class="code" href="remix__envelope_8h.html#a3">remix_envelope_set_timetype</a> (env, envelope, REMIX_TIME_BEAT24S);
  <a class="code" href="remix__envelope_8h.html#a8">remix_envelope_add_point</a> (env, envelope, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(0), 0.1);
  <a class="code" href="remix__envelope_8h.html#a8">remix_envelope_add_point</a> (env, envelope, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(48), 1.3);
  <a class="code" href="remix__envelope_8h.html#a8">remix_envelope_add_point</a> (env, envelope, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(96), 0.1);

<span class="preprocessor">#if 0</span>
<span class="preprocessor"></span>  remix_gain_set_envelope (env, gain, env);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  gain_key = <a class="code" href="remix_8h.html#a17">remix_get_parameter_key</a> (env, gain, <span class="stringliteral">"Gain envelope"</span>);
  printf (<span class="stringliteral">"got gain key: %d\n"</span>, gain_key);
  <a class="code" href="remix_8h.html#a18">remix_set_parameter</a> (env, gain, gain_key, (CDScalar)((<span class="keywordtype">void</span> *)envelope));
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
  deck = <a class="code" href="remix__deck_8h.html#a0">remix_deck_new</a> (env);
  track = <a class="code" href="remix__deck_8h.html#a4">remix_track_new</a> (env, deck);

  l1 = <a class="code" href="remix__deck_8h.html#a11">remix_layer_new_ontop</a> (env, track, REMIX_TIME_BEAT24S);
  <span class="keywordflow">for</span> (i=0; i &lt; 4; i++) {
    <a class="code" href="remix__deck_8h.html#a26">remix_sound_new</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)sf1, l1, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(i*24), <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(18));
  }

  track2 = <a class="code" href="remix__deck_8h.html#a4">remix_track_new</a> (env, deck);
  l2 = <a class="code" href="remix__deck_8h.html#a11">remix_layer_new_ontop</a> (env, track2, REMIX_TIME_BEAT24S);
  <span class="keywordflow">for</span> (i=0; i &lt; 16; i++) {
    <a class="code" href="remix__deck_8h.html#a26">remix_sound_new</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)sf2, l2, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(i*6), <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(4));
  }

  deck2 = <a class="code" href="remix__deck_8h.html#a0">remix_deck_new</a> (env);
  track3 = <a class="code" href="remix__deck_8h.html#a4">remix_track_new</a> (env, deck2);

  l3 = <a class="code" href="remix__deck_8h.html#a11">remix_layer_new_ontop</a> (env, track3, REMIX_TIME_BEAT24S);
  <a class="code" href="remix__deck_8h.html#a26">remix_sound_new</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)deck, l3, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(0), <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(96));

<span class="preprocessor">#if 1</span>
<span class="preprocessor"></span>  l4 = <a class="code" href="remix__deck_8h.html#a11">remix_layer_new_ontop</a> (env, track3, REMIX_TIME_BEAT24S);
  <a class="code" href="remix__deck_8h.html#a26">remix_sound_new</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)gain, l4, <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(0), <a class="code" href="remix__types_8h.html#a22">REMIX_BEAT24S</a>(96));
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
  l5 = <a class="code" href="remix__deck_8h.html#a11">remix_layer_new_ontop</a> (env, track3, REMIX_TIME_SAMPLES);

  length = <a class="code" href="remix_8h.html#a26">remix_length</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)deck);
  sm = <a class="code" href="remix__deck_8h.html#a26">remix_sound_new</a> (env, monitor, l5, <a class="code" href="remix__types_8h.html#a20">REMIX_SAMPLES</a>(0), <a class="code" href="remix__types_8h.html#a20">REMIX_SAMPLES</a>(length));

  printf (<span class="stringliteral">"deck: %p\ttrack: %p\tl1: %p\nl3: %p\tmonitor: %p\n"</span>,
          deck, track, l1, l3, monitor);

  <a class="code" href="remix_8h.html#a25">remix_process</a> (env, deck2, length, RemixNone, RemixNone);

  <a class="code" href="remix_8h.html#a9">remix_set_tempo</a> (env, 105);
  length = <a class="code" href="remix_8h.html#a26">remix_length</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)deck);
  <a class="code" href="remix__deck_8h.html#a37">remix_sound_set_duration</a> (env, sm, <a class="code" href="remix__types_8h.html#a20">REMIX_SAMPLES</a>(length));
  <a class="code" href="remix_8h.html#a27">remix_seek</a> (env, deck2, 0, SEEK_SET);
  <a class="code" href="remix_8h.html#a25">remix_process</a> (env, deck2, length, RemixNone, RemixNone);

  <a class="code" href="remix_8h.html#a9">remix_set_tempo</a> (env, 168);
  length = <a class="code" href="remix_8h.html#a26">remix_length</a> (env, (<a class="code" href="remix__types_8h.html#a27">RemixBase</a> *)deck);
  <a class="code" href="remix__deck_8h.html#a37">remix_sound_set_duration</a> (env, sm, <a class="code" href="remix__types_8h.html#a20">REMIX_SAMPLES</a>(length));
  <a class="code" href="remix_8h.html#a27">remix_seek</a> (env, deck2, 0, SEEK_SET);
  <a class="code" href="remix_8h.html#a25">remix_process</a> (env, deck2, length, RemixNone, RemixNone);

  <a class="code" href="remix_8h.html#a4">remix_purge</a> (env);

  exit (0);
}
</pre></div> sndfiledemo.c 
<p>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Tue Jan 13 12:05:54 2004 for remix by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
